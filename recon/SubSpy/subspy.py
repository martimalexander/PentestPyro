import os
import subprocess
from urllib.parse import urlparse


target = input("Enter the target domain eg google.com: ")
if target.startswith('https://'):
    print('Invalid Domain')
    exit()


print("Collecting subdomains...")
subprocess.run(["subfinder", "-d", target, "-o", f"{target}/subdomain.txt"], check=True)

subfile = f"{target}/subdomain.txt"
if not os.path.exists(subfile) or os.path.getsize(subfile) == 0:
    print("No subdomains found. Exiting...")
    exit()

print("Finding IPs...")
subprocess.run(["getips", "-d", subfile, "-o", f"{target}/ips.txt", "-v"], check=True)

ipfile = f"{target}/ips.txt"
if not os.path.exists(ipfile) or os.path.getsize(ipfile) == 0:
    print("No IPs Found. Exiting...")
    exit()

print("Starting Nmap on Ip.")
result_file = f"{target}/results.txt"
subprocess.run(["nmap", "-v", "--script", "vuln", "-iL", ipfile, "-oN", result_file], check=True)

print(f"Done! Results saved in {result_file}")
